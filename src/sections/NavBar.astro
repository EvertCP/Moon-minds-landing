<div>
    <header class="fixed inset-x-0 top-0 z-40 transition-transform duration-300" id="navbar">
        <nav class="flex items-center justify-between lg:px-8 bg-white/20 backdrop-blur-xl" aria-label="Global">
          <div class="flex lg:flex-1">
            <a href="/" class="-m-1.5 p-1.5">
              <span class="sr-only">Moon Minds</span>
              <img class="h-20 w-auto" src="../assets/moon-minds-logo-M.png" alt="">
            </a>
          </div>
          <div class="flex lg:hidden">
            <button id="menu-button" type="button" class="relative z-50 rounded-md p-2.5 text-gray-700" aria-label="Open menu">
              <span class="sr-only">Open main menu</span>
              <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              </svg>
            </button>
          </div>
          <div class="hidden lg:flex lg:gap-x-12">  
            <a href="/" class="text-xl font-semibold text-gray-900">Inicio</a>
            <a href="/servicios" class="text-xl font-semibold text-gray-900">Servicios</a>
            <div class="relative">
              <button id="productos-button" class="text-xl font-semibold text-gray-900">Productos</button>
              <div id="productos-menu" class="hidden absolute bg-white shadow-lg rounded-lg mt-2">
                <a href="/erp" class="block px-4 py-2 text-gray-800">ERP</a>
                <a href="/publicidad" class="block px-4 py-2 text-gray-800">Publicidad</a>
                <a href="/analisis" class="block px-4 py-2 text-gray-800">Análisis de datos</a>
                <a href="/agentes-virtuales" class="block px-4 py-2 text-gray-800">Agentes virtuales</a>
                <a href="/capacitacion" class="block px-4 py-2 text-gray-800">Capacitación</a>
                <a href="/desarrollo-software" class="block px-4 py-2 text-gray-800">Desarrollo de software</a>
                <a href="/produccion" class="block px-4 py-2 text-gray-800">Producción audiovisual</a>
              </div>
            </div>
            <a href="/nosotros" class="text-xl font-semibold text-gray-900">Sobre Nosotros</a>
            <a href="/contacto" class="text-xl font-semibold text-gray-900">Contacto</a>
          </div>
        </nav>
    </header>
    
    <!-- Mobile menu, separado completamente del navbar -->
    <div id="menu-backdrop" class="fixed inset-0 z-50 hidden bg-black/10 backdrop-blur-sm lg:hidden"></div>
    <div id="menu-mobile" class="fixed inset-y-0 right-0 z-50 hidden w-content max-w-sm shadow-lg bg-white overflow-y-auto lg:hidden">
        <div class="flex items-center justify-between px-6 pt-6">
          <a href="/" class="-m-1.5 p-1.5">
            <img class="h-20 w-auto" src="../assets/moon-minds-letra-azul.png" alt="Moon Minds">
          </a>
          <button id="menu-button1" type="button" class="rounded-md p-2.5 text-gray-700" aria-label="Close menu">
            <span class="sr-only">Close menu</span>
            <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="menu mt-6 flow-root px-6 pb-6 bg-white">
          <div class="-my-6 divide-y divide-gray-500/10 bg-white">
            <div class="space-y-2 py-6 bg-white">
              <a href="/" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-gray-900 hover:bg-gray-50">Inicio</a>
              <a href="/servicios" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-gray-900 hover:bg-gray-50">Servicio</a>
              <div class="relative">
                <button id="productos-button-mobile" class="-mx-3 flex w-full items-center justify-between rounded-lg py-2 pl-3 pr-3.5 text-base/7 font-semibold text-gray-900 hover:bg-gray-50">Productos</button>
                <div id="productos-menu-mobile" class="hidden mt-2 space-y-2 pl-6">
                  <a href="/erp" class="block px-4 py-2 text-gray-800">ERP</a>
                  <a href="/publicidad" class="block px-4 py-2 text-gray-800">Publicidad</a>
                  <a href="/analisis" class="block px-4 py-2 text-gray-800">Análisis de datos</a>
                  <a href="/agentes-virtuales" class="block px-4 py-2 text-gray-800">Agentes virtuales</a>
                  <a href="/capacitacion" class="block px-4 py-2 text-gray-800">Capacitación</a>
                  <a href="/desarrollo-software" class="block px-4 py-2 text-gray-800">Desarrollo de software</a>
                  <a href="/produccion" class="block px-4 py-2 text-gray-800">Producción audiovisual</a>
                </div>
              </div>
              <a href="/nosotros" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-gray-900 hover:bg-gray-50">Sobre nosotros</a>
              <a href="/contacto" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-gray-900 hover:bg-gray-50">Contacto</a>
            </div>
          </div>
        </div>
    </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Elementos del DOM
    const navbar = document.getElementById('navbar');
    const mobileMenu = document.getElementById('menu-mobile');
    const backdrop = document.getElementById('menu-backdrop');
    const openButton = document.getElementById('menu-button');
    const closeButton = document.getElementById('menu-button1');
    
    // Variables de control
    let lastScrollY = window.scrollY;
    let isMobileMenuOpen = false;
    
    // Función simple para abrir el menú
    function openMenu() {
      if (!mobileMenu || !backdrop) return;
      
      mobileMenu.classList.remove('hidden');
      backdrop.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
      isMobileMenuOpen = true;
      
      // Asegurar que la barra esté visible
      if (navbar) navbar.style.transform = 'translateY(0)';
    }
    
    // Función simple para cerrar el menú
    function closeMenu() {
      if (!mobileMenu || !backdrop) return;
      
      mobileMenu.classList.add('hidden');
      backdrop.classList.add('hidden');
      document.body.style.overflow = '';
      isMobileMenuOpen = false;
    }
    
    // Control de scroll
    function handleScroll() {
      const currentScrollY = window.scrollY;
      
      // Verificar estado actual del menú
      if (mobileMenu) {
        isMobileMenuOpen = !mobileMenu.classList.contains('hidden');
      }
      
      if (navbar) {
        if (isMobileMenuOpen) {
          // Menú abierto: navbar siempre visible
          navbar.style.transform = 'translateY(0)';
        } else {
          // Menú cerrado: comportamiento normal
          if (currentScrollY < lastScrollY || currentScrollY <= 0) {
            navbar.style.transform = 'translateY(0)';
          } else {
            navbar.style.transform = 'translateY(-100%)';
          }
        }
      }
      
      lastScrollY = currentScrollY;
    }

    // Asignar eventos
    if (openButton) openButton.addEventListener('click', function(e) {
      e.preventDefault();
      openMenu();
    });
    
    if (closeButton) closeButton.addEventListener('click', function(e) {
      e.preventDefault();
      closeMenu();
    });
    
    if (backdrop) backdrop.addEventListener('click', closeMenu);
    
    // Cerrar con ESC
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && isMobileMenuOpen) closeMenu();
    });
    
    // Control de scroll
    window.addEventListener('scroll', handleScroll);
    
    // Inicializar
    handleScroll();
    // Submenú Productos (desktop)
    const productosButtonDesktop = document.getElementById('productos-button');
    const productosMenuDesktop = document.getElementById('productos-menu');
    if (productosButtonDesktop && productosMenuDesktop) {
      // Mostrar al hacer hover
      productosButtonDesktop.addEventListener('mouseenter', () => {
        productosMenuDesktop.classList.remove('hidden');
      });
      productosMenuDesktop.addEventListener('mouseenter', () => {
        productosMenuDesktop.classList.remove('hidden');
      });
      // Ocultar al salir
      productosButtonDesktop.addEventListener('mouseleave', () => {
        setTimeout(() => {
          if (!productosMenuDesktop.matches(':hover') && !productosButtonDesktop.matches(':hover')) {
            productosMenuDesktop.classList.add('hidden');
          }
        }, 100);
      });
      productosMenuDesktop.addEventListener('mouseleave', () => {
        setTimeout(() => {
          if (!productosMenuDesktop.matches(':hover') && !productosButtonDesktop.matches(':hover')) {
            productosMenuDesktop.classList.add('hidden');
          }
        }, 100);
      });
      // Mostrar/ocultar al hacer clic
      productosButtonDesktop.addEventListener('click', (e) => {
        e.preventDefault();
        productosMenuDesktop.classList.toggle('hidden');
      });
      // Cerrar al hacer clic fuera
      document.addEventListener('click', (e) => {
        if (!productosMenuDesktop.contains(e.target) && e.target !== productosButtonDesktop) {
          productosMenuDesktop.classList.add('hidden');
        }
      });
    }

    // Submenú Productos (mobile)
    const productosButton = document.getElementById('productos-button-mobile');
    const productosMenu = document.getElementById('productos-menu-mobile');
    if (productosButton && productosMenu) {
      productosButton.addEventListener('click', (e) => {
        e.stopPropagation();
        productosMenu.classList.toggle('hidden');
      });
      // Cierre del submenú
      document.addEventListener('click', (e) => {
        if (!productosMenu.contains(e.target) && e.target !== productosButton) {
          productosMenu.classList.add('hidden');
        }
      });
    }
    
    // Asegurar que el navbar esté visible cuando se abre el menú móvil
    if (openButton && navbar) {
      openButton.addEventListener('click', () => {
        navbar.style.transform = 'translateY(0)';
      });
    }
  });
</script>